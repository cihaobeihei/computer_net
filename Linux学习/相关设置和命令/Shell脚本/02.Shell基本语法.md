# Shell基本语法
## 1.脚本第一行
脚本第一行可以规定解释器，语法是：<br>
```shell
#!/bin/bash
......
```
脚本的第一行告诉Linux系统，如果解释该文本中的内容，但必须放在第一行。<br>

## 2.注释
Shell脚本中的注释使用的是``#``,如下：<br>
```shell
#这是注释
#这是注释
#这是注释
#这是注释
```

我们也可以使用其他方法注释，比如：<br>
```shell
:<<EOF
echo "noble victor"
EOF
```
上面的这种方法可以一次注释多行，不过尽量少用。<br>

## 3.变量
在shell中变量可以直接定义，不用管类型。在使用变量时需要用``$``修饰变量，意思是使用变量的值，类似的对一串命令，如果我们要得到它的结果，就用``$()``获得它的值。<br>
```shell
Noble="surperman";
echo ${Noble};
```
在上面的实例中，如果我们使用的变量会和其他字符连在一起，就使用``{}``将变量括起来。<br>

## 4.bansh传递参数
我们给脚本传递参数的方式和执行C代码程序类似，在运行脚本的命令后面加上参数，类似如下：<br>
```shell
bash test.sh arg1 arg2
```

__特别参数符号使用__<br>
- ``$0`` 表示文件名
- ``$n`` 表示第n个参数
- ``$#`` 表示参数的个数
- ``$@`` 接受传递的所有参数，支持迭代器的使用方法
- ``$*`` 接受传递的所有参数，并将他们当做一个字符串，不支持迭代器的使用方法
- ``$$`` 获得当前执行脚本的进程号``PID``
- ``$!`` 获得上一个后台进程的``PID``，也就是当前的``PPID``
- ``$?`` 获取上一个命令的返回值，如果为0说明执行正确，非0表示执行错误。以前，在``make``编译完成源码后，我们会使用``echo $?``检查是否编译正确。
- $_ 获取在此之前执行的脚本或命令的最后一个参数。

## 5.字符串操作
- ``${string}`` 返回变量``string``的内容
- ``${#string}`` 返回变量``string``字符串的长度
- ``${string:offset}`` 在字符串变量``string``中，减去``offset``个字节 取后面的字符串。offset是int型
- ``${string:offset:length}`` 取``offse``t字节后面``length``个字节
- ``${string#word}`` 从变量``string`` *开头* 删除 **最短** 匹配的``word``子串
- ``${string##word}`` 从变量``string`` *开头* 删除 **最长** 匹配的``word``子串
- ``${string%word}`` 从变量``string`` *结尾* 删除 **最短** 匹配的``word``子串
- ``${string%%word}`` 从变量``string`` *结尾* 删除 **最长** 匹配的``word``子串
- ``${string/oldstr/newstr}`` 使用``newstr``替换第一个匹配的``oldstr``
- ``${string//oldstr/newstr}`` 使用``newstr``替换所有匹配的``oldstr``

### 特殊扩展规则说明
- ``${paramenter:-words}`` 如果``paramenter``变量的值为空(即未赋值)，则会返回``words``字符串值。(注意：``paramenter``是变量，而``words``是字符串)
- ``${paramenter:=words}`` 如果``paramenter``变量的值为空(即未赋值)，则会返回``words``字符串值，并用``words``赋值给``paramenter``。
- ``${paramenter:?words}`` 如果``paramenter``变量的值为空(即未赋值)，那么``bash``会输出错误提示字符串，提示字符串中包含``words``子串。
- ``${paramenter:+words}`` 如果``paramenter``变量的值为空(即未赋值)，什么都不做。否则``words``字符串替代``paramenter``变量的值。

一般常用的就是第一个，后三个用的不多。<br>

## 6.算数运算符
Shell中常见的算数符号<br>

|算数运算符|意义|
|---------|----|
| +、-  | 加法、减法  |
| *、/、%  | 乘法、除法、取余  |
| **  | 幂运算  |
| ++、--  | 增加、减少  |
| !、&&、ll  | 逻辑非、逻辑与、逻辑或  |
| <、<=、>、>=  | 比较符号  |
| ==、!=、=  | 等于、不等于、赋值  |
| <<、>>  | 左移位、右移位  |
| ~、l、&、^  | 按位取反、按位异或、按位与、按位或  |
| +=、-=、*=、\=、%=  | 同C语法  |


Shell中常见的算数运算命令<br>

|运算操作符与命令|意义|
|--------------|----|
| (())  | 用于整数运算的常用运算符，效率很高  |
| let  | 用于整数运算，类似于(())  |
| $[]  | 用于整数运算  |
| expr  | 可用于整数运算，同时还要很多其他功能  |
| bc  | Linux下的一个计算程序  |
| awk  | 既可以用于整数运算也可以用于小数运算  |
| declare  | 定义变量值和属性，-i参数可以用于定义整形变量，做运算  |

## 7.Shell中的函数
在shell使用函数一般格式是：<br>
```
. /etc/init.d/functions

#调用函数
apply_sysctl
```

shell脚本中的``.``就类似于C中的include语句。<br>
不带参数的函数执行时，是不带小括号的，直接输入函数名即可。<br>

其他函数规则的重要说明：<br>
- 1.执行函数时，函数名钱的function和函数后面的小括号都不要带
- 2.函数的定义必须在要执行前面定义或声明
- 3.Shell脚本中的函数变量默认是全局的，当我们定义前加local关键字时，可以定义为局部变量
- 4.return和exit的区别同C/C++
- 5.如果函数存放在独立的文件中，我们要使用这些函数需要用``source``或``.``加载。

Shell函数案例(检查URL)：<br>
```shell
#!/bin/bash
##############################################################
# File Name: test.sh
# Version: V1.0
# Author: noble
# Created Time : 2018-10-10 14:16:34
# Description:
##############################################################
function Usage()
{
    echo "Usage:$0 URL"
    exit 1
}

function CheckURL()
{
    URL=$1
    if [ -z $URL ]
    then
        Usage
        exit
    fi
    wget -q -o /dev/null -t 2 -T 5 $1
    if [ $? -eq 0 ]
    then
        echo "$1 ok"
    else
        echo "$1 failed"
    fi
}

function main()
{
    CheckURL $1
}
main $*
```




























#
