# 基础要求：
__1.系统的日志文件/var/log/secure /var/log/messages /var/log/cron会自动的进行轮询，系统是通过什么实现的？__<br>
- 系统是通过系统的定时任务实现的，定期执行logrotate工具对系统日志文件进行轮询

__2.写出下面特殊符号在定时任务中的含义：__<br>
- \* */n 09-19
- 在每月9号到19号每隔n个小时的每分钟执行一次

__3.某年某月某日某时，某人在工作中设置crontab定时任务规则保存时，提示“No space left on device”,此时用df -h检查磁盘，发现还有剩余空间，请问是什么原因及如何排查，什么导致这种事发生？__<br>
- 原因可能是inode使用完了，我们可以用命令df -i命令查看inode使用情况，每个文件占用一个inode，所以是文件太多了
- 定时任务 会产生文件，如果没有追加到/etc/null 2>&1 中随时间增长会有很多小文件生成

__4.书写定时任务完成：每天晚上12点备份/etc/rc.local /etc/sysconfig/ /var/spool/cron /etc/fstab 这些文件到/backup目录__<br>
- 00 00 * * * sh cot_bak.sh
- 脚本/scripts中的cot_bak.sh：
- tar -zcf /backup/contant.tar.gz /etc/rc.local /etc/sysconfig/* /var/spool/cron /etc/fstab
- 检查：
    - 看日志 tail -f /var/log/cron
    - 看结果

    ```
    [root@pro etc]# ll /backup/
    -rw-r--r--. 1 root root 56138 Apr  5 08:31 contant.tar.gz


    Apr  5 08:00:00 pro crond[1616]: (root) RELOAD (/var/spool/cron/root)
    Apr  5 08:00:00 pro CROND[49064]: (root) CMD (sh cot_bak.sh)
    ```

__5.每天凌晨1点备份/var/www/html目录到/backup下面以本机ip地址命令的目录中__<br>
- 00 00 * * * sh html_bak.sh
- 脚本/scripts中的html_bak.sh：
- tar -zcf /backup/html_bak.tar.gz /var/www/html
- 检查：
    ```
    [root@pro etc]# ll /backup/
    -rw-r--r--. 1 root root 56142 Apr  5 21:14 html_bak.tar.gz


    Apr  5 08:00:00 pro crond[3131]: (root) RELOAD (/var/spool/cron/root)
    Apr  5 08:00:00 pro CROND[49078]: (root) CMD (sh html_bak.sh)
    ```
__6.每天晚上12点备份/etc/目录到/backup目录下面，并且删除7天之前的备份？__<br>
- 在 crontab -e中配置
    - #backup etc_file by noble in 20180406
    - 00 00 * * * /bin/sh /scripts/qus_six.sh >/dev/null 2>&1
- 在/scripts中配置脚本qus_six.sh
    - tar -zcf /backup/etc_$(date +%F).tar.gz /etc/*
    - find /backup/ -type f -name 'etc_*.tar.gz' -mtime +7  |xargs rm -f

__7.简述linux用户分为几类，什么是虚拟用户？怎么区分虚拟用户与普通用户？__<br>
- Linux用户分为3类：root，虚拟用户，普通用户
- root用户UID，GID是0，虚拟用户UID，GID在1~499，普通用户UID，GID大于等于500
- 虚拟用户是为了让Linux中的进程用于用户，本身没有登录权限，
- 虚拟用户的shell是/sbin/nologin 普通用户默认是/bin/bash

__8.创建一个UID为999的虚拟用户mysql__<br>
- useradd -u 999 -M -s /sbin/nologin  mysql

__9.命令提示符出现-bash-4.1$如何解决？__<br>
- cp /etc/skel/.bash* ~

__10.给oldboy用户授权以root身份执行ls，touch，passwd命令，但禁止修改root用户密码？__<br>
- 在visudo的92行加
    - noble   ALL=(ALL)       /bin/ls,/bin/touch,/usr/bin/passwd,!/usr/bin/passwd root

# 升级需求：
__1.每天晚上12点备份/etc/目录到/backup下面的以ip地址命名的目录中，并删除目录中7天之前的备份，但要保存每周1的内容__<br>

- 脚本内容：
```
#/bin/bash
#desc：
# 1判断ip目录是否存在，不存在创建目录
# 2以当天时间打包/etc并以当天时间命名文件名
# 3从ip目录下遍历所有符合以上命名规则(etc_日期.tar.gz)的文件
# 4判断是否为周一，如果是 touch这个文件，把时间改成今天(文件名不变还是以前的时间命名，只改变修改时间)
# 5删除过时文件
IP=$(ip route |sed -n '1p' |awk '{print $9}')
if [ ! -d /backup/$IP ]
then
    mkdir -p /backup/$IP
    echo creat file
else
    echo file exsist
fi
tar -zcf /backup/$IP/etc_$(date +%F).tar.gz /etc/*

for file_name in $(ls /backup/$IP)
do
    echo $file_name
    time_file=$( echo $file_name |awk -F '[_.]' '{print $2}' )
    week=$(date -d "$time_file" +%w)
    if [ $week -eq 1 ];then
         touch $file_name
    fi

done
cd /backup/$IP
find  -type f -mtime +7
find  -type f -mtime +7 |xargs rm -f
#没有问题亲测有效
#脚本完成了，定时任务写法和基础需求中一致，不再重复
```

__2.创建10个用户stu01.....stu10并设置随机8位密码__<br>
- 两条命令：
```
seq -w 10|sed -r "s#(.*)#useradd stu\1#g"|bash
seq -w 10|sed -r 's#(.*)#jack="$((RANDOM))" ;echo $jack|passwd --stdin stu\1;echo "stu\1:$jack">>/passwd.log#g'|bash
```