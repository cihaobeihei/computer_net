# 文件操作
- 1包含头文件
- 2定义FILE指针
- 3打开文件
- 4读写操作
- 5关闭文件

## 1.文件分类
#### 按文件的逻辑结构：
- 记录文件： 由具有一定的记录组成（定长和不定长）
- 流式文件： 由一个个字符（字节）数据顺序组成
#### 按存储介质：
- 普通文件： 存储介质文件（磁盘，磁带等）
- 设备文件： 非存储介质（键盘，显示器，打印机等）
#### 按数据的组织形式：（重点）
- 文本文件： ASCII文件每个字节存放一个ASCII码的文件
- 二进制文件： 数据按其在内存中的存储形式原样存放
## 2.流概念
流是一个动态的概念，可以将一个字节形象地比喻成一滴水，
字节在设备、文件和程序之间的传输就是流，类似于水在管道中的传输，
可以看出，流是对输入输出源的一种抽象，也是对传输信息的一种抽象。
通过对输入输出源的抽象，屏蔽了设备之间的差异，使程序员能以一种通用的方式
进行存储操作，通过对传输信息的抽象，使得所有信息都转化为字节流的形式传输，
信息解读的过程与传输过程分离。<br>
C语言中，I/O操作可以简单的看做是从程序移进或移出字节，这种搬运的过程便成为流
（steam）。程序员只需要关心是否正确地输入了字节数据，以及是否正确地输入了
要读取字节数据，特定I/O设备的细节对程序员是透明的。<br>

## 3.文件处理的方法
- 1）文件缓冲区<br>
ANSI C标准采取“缓冲文件系统”处理数据文件，所谓缓冲文件系统
是指系统自动地在内存区为程序中每一个正在使用的文件开辟一个文件缓冲区，
从内存向磁盘输出数据必须先送到内存中的缓冲区，装满缓冲区后才一起送到磁盘。
如果从磁盘向计算机读取数据，则一次从磁盘将一批数据输入到内存缓冲区（充满缓冲区）
，然后再从缓冲区逐个地将数据送到程序数据区（给程序变量）<br>
- 2)输入输出流<br>
输入输出是数据传送的过程，数据如流水一样从一处流向另一处，因此常将输入输出形象
地称为流（stream），即数据流。表示了信息从源到目的的流动。<br>
![](img/4.1.png)<br>
输入操作时，数据从文件流向计算机内存---文件的读取<br>
![](img/4.2.png)<br>
输出操作时，数据从计算机内存流向文件---文件的读取<br>
![](img/4.3.png)<br>

无论是用word打开或保存文件，还是C程序中的输入输出都是通过操作系统
进行的。“流”是一个传输通道，数据可以从运行环境流入程序中，或从程序流至运行环境<br>

## 4.文件句柄
```C
typedef struct
{
  short         level;        //缓冲区“满”或“空”的程度
  unsigned      flags;        //文件状态标志
  char          fd;           //文件描述符
  unsigned char hold;         //如无缓冲区不读取字符
  short         bsize;        //缓冲区的大小
  unsigned char *buffer;      //数据缓冲区的位置
  unsigned      ar;           //指针，指向当前的指针
  unsigned      istemp;       //临时文件，指示器
  short         token;        //用于有效性检查
}FILE；
```

## 5.C语言文件指针
__在C语言中用一个指针变量指向一个文件，这个指针成为文件指针__<br>
声明FILE结构体类型的信息包含在头文件"stdio.h"中<br>
一般设置一个指向FILE类型的指针变量，然后通过它来引用这些FILE类型变量，通过文件指针就可以对它所指的文件进行操作。<br>
定义文件的指针一般操作是：<br>
<br>__FILE* 指针变量标识符;__<br>
其中FILE应为大写，它实际是由系统定义的一个结构，该结构中含有文件名、文件状态和文件，当前位置等信息。在编写源文件时程序员不需要关系FILE结构的细节。<br>
<br>__FILE* fp;__<br>
表示fp是指向FILE的文件指针变量，通过fp即可找存放在某个文件信息的结构变量，然后按结构变量提供的信息找到该文件，实施对文件的操作。习惯上也叫fp为指向一个文件的指针。<br>

## 6.文件操作的API
fgetc()　　　　　fputc() 按字符读写文件<br>
fgets()　　　　　fputs() 按字符串读写文件<br>
fread()　　　　　fwirte() 按块读写文件（大文件操作）<br>
fprintf　　　　　　　　　按格式化读写操作<br>

## 7.标准的文件读写
__1.文件的打开fopen()__<br>
文件的打开操作表示将给用户指定的文件在内存分配一个FILE结构区，并将该结构的指针返回给用户程序，以后用户程序就可以用此FILE指针实现对文件的各项操作。当使用打开函数fopen()时，必须给出文件名，文件操作方式（读或写，下面的表格会列出各项操作符），如果该文件名不存在，就意味着创建（只对写文件有效，读文件时会报错），并将文件指针指向该文件的开头。<br>
```C
FILE *fp;
fp = fopen(char *filename,char *type);
//期中*filename是文件的路径，要用""引起来
```
![](img/4.4.png)<br>
