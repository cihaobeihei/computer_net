# php文件目录操作

## 1.创建目录(mkdir),创建文件($filename,fopen("w+"))
```php
bool mkdir (string $pathname [,int $mode [,bool $recursive [,resource $context ]]] );
```
```php
<?php 
mkdir("/path/to/my/dir", 0777);  //成功返回true,失败返回false;
$fileHandle = fopen("noble.txt","w+");
```

**fopen第二个参数说明:**<br>
|mode|说明|
|----|----|
| r  |只读方式打开,偏移量是文件开头|
| r+ |读写方式打开,偏移量是文件开头|
| w  |只写方式打开,偏移量是文件开头.如果文件存在,即截断,不存在则创建该文件|
| w+ |读写方式打开,偏移量是文件开头.如果文件存在,即截断,不存在则创建该文件|
| a  |只写方式打开,偏移量是文件结尾.如果该文件不存在，函数将创建这个文件|
| a+ |读写方式打开,偏移量是文件结尾.如果该文件不存在，函数将创建这个文件|


## 2.判断文件是否存在(file_exist)
```php
bool file_exists (string $filename );
```
```php
<?php 
$filename = '/path/to/phpernote.txt';
echo file_exists($filename)?'文件存在':'文件不存在';
```

## 3.检查指定路径是否是目录,一般也用于判断目录是否存在(is_dir)
```php
bool is_dir(string $filename);
```
```php
var_dump(is_dir("noble/txt")); //true表示存在
```
**注释：** 本函数的结果会被缓存。请使用 clearstatcache() 来清除缓存<br>

## 4.判断给定文件名是否为一个正常的文件(is_file)
```php
bool is_file ( string $filename );
```
```php
var_dump(is_file("noble/text"));
```

## 5.读取文件(fread(),fgets())
fread()函数从指定的资源中读取length个字符当到达EOF（文件结束符）或者读取到length个字符时读取将停止。<br>
```php
$fileHandle = fopen($filePath, "a+");
$str = fread($fileHandle, filesize($filePath));
```

fgets()函数从handle（句柄）指定的资源中读取一行字符。碰到换行符（包括在返回值中）、EOF或者已经读取了length-1字节后停止（看先碰到哪一种情况）<br>
```php
$fileHandle = fopen($filePath, "a+");

//fgets()从句柄中指定的资源中按某一标准读取一行字符。
while ($str = fgets($fileHandle)) { //遍历读取全部内容
    echo nl2br($str); //按换行符读取
}
```

## 6.锁定或释放文件(flock)
```php
bool flock ( string $filename, string $lock [,mix $block] );
```
参数是以下几种:<br>
- 1.要取得共享锁定（读取的程序），将 lock 设为 ``LOCK_SH``（PHP 4.0.1 以前的版本设置为 1）
- 2.要取得独占锁定（写入的程序），将 lock 设为 ``LOCK_EX``（PHP 4.0.1 以前的版本中设置为 2）
- 3.要释放锁定（无论共享或独占），将 lock 设为 ``LOCK_UN``（PHP 4.0.1 以前的版本中设置为 3）
- 4.如果不希望 flock() 在锁定时堵塞，则给 lock 加上 ``LOCK_NB``（PHP 4.0.1 以前的版本中设置为 4）

```php
<?php
$file = fopen("noble.txt","w+");
if(flock($file,LOCK_EX)){
    if(is_writable($file)){
        fwrite($file,"php很简单");
    }
    //解锁
    flock($file,LOCK_UN);
}else{
    echo "文件锁定失败";
}
```