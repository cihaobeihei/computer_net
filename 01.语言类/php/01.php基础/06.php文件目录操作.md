# php文件目录操作

## 1.创建目录(mkdir),创建文件($filename,fopen("w+"))
```php
bool mkdir (string $pathname [,int $mode [,bool $recursive [,resource $context ]]] );
```
```php
<?php 
mkdir("/path/to/my/dir", 0777);  //成功返回true,失败返回false;
$fileHandle = fopen("noble.txt","w+");
```

**fopen第二个参数说明:**<br>
|mode|说明|
|----|----|
| r  |只读方式打开,偏移量是文件开头|
| r+ |读写方式打开,偏移量是文件开头|
| w  |只写方式打开,偏移量是文件开头.如果文件存在,即截断,不存在则创建该文件|
| w+ |读写方式打开,偏移量是文件开头.如果文件存在,即截断,不存在则创建该文件|
| a  |只写方式打开,偏移量是文件结尾.如果该文件不存在，函数将创建这个文件|
| a+ |读写方式打开,偏移量是文件结尾.如果该文件不存在，函数将创建这个文件|


## 2.判断文件是否存在(file_exist)
```php
bool file_exists (string $filename );
```
```php
<?php 
$filename = '/path/to/phpernote.txt';
echo file_exists($filename)?'文件存在':'文件不存在';
```

## 3.检查指定路径是否是目录,一般也用于判断目录是否存在(is_dir)
```php
bool is_dir(string $filename);
```
```php
var_dump(is_dir("noble/txt")); //true表示存在
```
**注释：** 本函数的结果会被缓存。请使用 clearstatcache() 来清除缓存<br>

## 4.判断给定文件名是否为一个正常的文件(is_file)
```php
bool is_file ( string $filename );
```
```php
var_dump(is_file("noble/text"));
```

## 5.读取文件(fread(),fgets())
fread()函数从指定的资源中读取length个字符当到达EOF（文件结束符）或者读取到length个字符时读取将停止。<br>
```php
$fileHandle = fopen($filePath, "a+");
$str = fread($fileHandle, filesize($filePath));
```

fgets()函数从handle（句柄）指定的资源中读取一行字符。碰到换行符（包括在返回值中）、EOF或者已经读取了length-1字节后停止（看先碰到哪一种情况）<br>
```php
$fileHandle = fopen($filePath, "a+");

//fgets()从句柄中指定的资源中按某一标准读取一行字符。
while ($str = fgets($fileHandle)) { //遍历读取全部内容
    echo nl2br($str); //按换行符读取
}
```

## 6.文件写入函数
### 6.1fwrite()
向handle文件描述符写入string,如果设置了length,则最多写入length长度的数据,就停止<br>
返回值:返回写入的字符个数,如果失败返回false<br>
```php
int fwrite( resource handle, string string [, int length] )
```

### 6.2.file_put_contents()

```php
int file_put_contents ( string filename, string data [, int flags [, resource context]] )
```
| 参数 | 说明 |
|-----|-------|
| filename | 需要写入的文件名|
|data | 要写入的数据。类型可以是 string，array（但不能为多维数组），或者是 stream 资源|
|flags|可选，规定如何打开/写入文件。可能的值：<br>1.FILE_USE_INCLUDE_PATH：检查 filename 副本的内置路径<br>2.FILE_APPEND：在文件末尾以追加的方式写入数据<br>3.LOCK_EX：对文件上锁|
|context|可选，Context是一组选项，可以通过它修改文本属性|

## 7.锁定或释放文件(flock)
```php
bool flock ( string $filename, string $lock [,mix $block] );
```
参数是以下几种:<br>
- 1.要取得共享锁定（读取的程序），将 lock 设为 ``LOCK_SH``（PHP 4.0.1 以前的版本设置为 1）
- 2.要取得独占锁定（写入的程序），将 lock 设为 ``LOCK_EX``（PHP 4.0.1 以前的版本中设置为 2）
- 3.要释放锁定（无论共享或独占），将 lock 设为 ``LOCK_UN``（PHP 4.0.1 以前的版本中设置为 3）
- 4.如果不希望 flock() 在锁定时堵塞，则给 lock 加上 ``LOCK_NB``（PHP 4.0.1 以前的版本中设置为 4）

```php
<?php
$file = fopen("noble.txt","w+");
if(flock($file,LOCK_EX)){
    if(is_writable($file)){
        fwrite($file,"php很简单");
    }
    //解锁
    flock($file,LOCK_UN);
}else{
    echo "文件锁定失败";
}
```

## 8.复制,重命名,删除文件

### 8.1.复制文件
copy() 函数用于拷贝文件，如果成功则返回 TRUE，失败则返回 FALSE<br>
```php
bool copy( string file, string newfile )
```

### 8.2.删除文件
unlink() 函数用于删除一个文件，如果成功则返回 TRUE，失败则返回 FALSE<br>
```php
bool unlink( string filename )
```