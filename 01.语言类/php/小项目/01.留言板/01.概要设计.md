# 留言板概要设计

## 1.对象
- 1.用户
- 2.留言板

## 2.约束条件
- 1.一个用户有1个留言板
- 2.任何用户可以在任何留言板上留言
- 3.用户可以删除自己留言版上的任何内容
- 4.用户在其他留言板上只能删除自己的留言
- 5.需要一个admin管理后台
    - 1.添加用户,删除用户
    - 2.浏览所有留言板的内容

# 详细设计
## 1.数据表设计
```sql
SET NAMES utf8;
SET FOREIGN_KEY_CHECKS = 0;
```
### 1.1.用户
| id | 用户名 | 密码 | 自己留言板id | role |
|----|-------|-------|-------|------|

```sql
CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '用户表id',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(50) NOT NULL COMMENT '用户密码',
  `board_id` int(11) NOT NULL COMMENT '留言板id',
  `role` int(4) NOT NULL COMMENT '角色0-管理员,1-普通用户',
  PRIMARY KEY (`id`),
  UNIQUE KEY `user_name_unique` (`username`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8;
```
```sql
BEGIN;
INSERT INTO `user` VALUES ('1', 'admin', '123456', '1', '1'), ('13', 'geely', '123456','13','0'), ('17', 'rosen', '123456', '17','0'), ('21', 'soonerbetter', '123456', '21','0');
COMMIT;
```

### 1.2.留言板
| id | 用户id |
|-----|------|

```sql
CREATE TABLE `board`(
    `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '留言板id',
    `user_id` int(11) NOT NULL COMMENT '用户id',
    PRIMARY KEY (`id`)
)ENGINE=InnoDB AUTO_INCREMENT=30 DEFAULT CHARSET=utf8;
```
```sql
BEGIN;
INSERT INTO `board` VALUES ('1','1'),('13','13'),('17','17'),('21','21');
COMMIT;
```



### 1.3.留言表
| id | 留言表id | 发言者id | 内容 | 创建时间 |
|----|---------|---------|------|----------|

```sql
CREATE TABLE `message`(
    `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '留言id',
    `board_id` int(11) NOT NULL COMMENT '留言板id',
    `user_id` int(11) NOT NULL COMMENT '用户id',
    `content` varchar(100) NOT NULL COMMENT '留言内容',
    `create_time` datetime DEFAULT NULL COMMENT '创建时间',
    PRIMARY KEY (`id`)
)ENGINE=InnoDB AUTO_INCREMENT=118 DEFAULT CHARSET=utf8;
```
```sql
BEGIN;
INSERT INTO `message` VALUES ('1','1','1','我是管理员,你们的老大哥','2019-07-08 21:27:06');
COMMIT;
```


## 2.功能模块

### 2.1.UserController
```
ServerResponse<User> login(string username, string passwd);
ServerResponse<User> register(User user);
ServerResponse<User> logout();
ServerResponse<User> getUserInfo();
```

### 2.2.UserManageController
```
ServerResponse<User> login(string username, string passwd);
```

### 2.3.MessageController
```
ServerResponse<Boolean> add(Integer boardId, string content);
ServerResponse<MessageVo> search(Integer boardId);
ServerResponse<MessageVo> searchOnes(Integer boardId, Integer userId);
ServerResponse<Boolean> del(Integer messagetId);
```

### 2.4.MessageManageController
```
ServerResponse<MessageVo> searchOnes(Integer boardId, Integer userId);
```